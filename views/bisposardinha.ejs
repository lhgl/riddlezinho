<!DOCTYPE html>
<html dir="ltr" lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0" name="viewport"/>
    <link href="/images/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
    <link href="/images/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
    <link href="/images/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
    <link color="#5bbad5" href="/images/safari-pinned-tab.svg" rel="mask-icon">
    <meta content="#da532c" name="msapplication-TileColor">
    <meta content="#ffffff" name="theme-color">
    <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" rel="stylesheet">
    <script crossorigin="anonymous"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.slim.min.js" integrity="sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI=" crossorigin="anonymous"></script>
    <link href="/styles/reset.css" rel="stylesheet">
    <link href="/styles/fases.css" rel="stylesheet">
    <link href="/styles/custom.css" rel="stylesheet">
    <script async src="/scripts/fases.js"></script>
    <title>Coração</title>
</head>
<body>


<div id="user-progress-badge" class="user-progress-badge">
  <span class="progress-label">Seu Progresso</span>
  <span class="progress-value">--%</span>
  <span class="score-label">Carregando...</span>
</div>

<style>
.user-progress-badge {
    position: absolute;
    top: 20px;
    left: 20px;
    background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
    color: white;
    padding: 15px 20px;
    border-radius: 10px;
    display: flex;
    flex-direction: column;
    align-items: center;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    z-index: 1000;
    min-width: 120px;
}
.progress-label {
    font-size: 11px;
    opacity: 0.9;
    margin-bottom: 5px;
    text-align: center;
}
.progress-value {
    font-size: 28px;
    font-weight: bold;
    line-height: 1;
}
.score-label {
    margin-top: 8px;
    background: rgba(255,255,255,0.2);
    padding: 4px 12px;
    border-radius: 12px;
    font-size: 12px;
}
</style>


<script>
// User Progress Badge - Dynamic Data
(function() {
  function loadUserProgress() {
    const token = localStorage.getItem('authToken');
    if (!token) {
      // Usuário não logado
      const badge = document.getElementById('user-progress-badge');
      if (badge) {
        badge.innerHTML = `
          <span class="progress-label">Seu Progresso</span>
          <span class="progress-value">--%</span>
          <span class="score-label">Não logado</span>
        `;
      }
      return;
    }

    fetch('/auth/profile', {
      headers: { 'Authorization': 'Bearer ' + token }
    })
    .then(res => {
      if (!res.ok) throw new Error('Não autorizado');
      return res.json();
    })
    .then(data => {
      const stats = data.user.stats || {};
      const completedPhases = stats.completedPhases || 0;
      const totalPhases = 99;
      const progress = Math.floor((completedPhases / totalPhases) * 100);
      const score = stats.score || 0;

      const badge = document.getElementById('user-progress-badge');
      if (badge) {
        badge.innerHTML = `
          <span class="progress-label">Seu Progresso</span>
          <span class="progress-value">${progress}%</span>
          <span class="score-label">${score} pts</span>
        `;
      }
    })
    .catch(err => {
      console.log('Erro ao carregar progresso:', err);
      localStorage.removeItem('authToken');
      localStorage.removeItem('user');
    });
  }

  // Carregar quando DOM estiver pronto
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', loadUserProgress);
  } else {
    loadUserProgress();
  }
})();
</script>



<style>
.phase-score-display {
    position: absolute;
    top: 20px;
    right: 20px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 15px 20px;
    border-radius: 10px;
    display: flex;
    flex-direction: column;
    align-items: center;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    z-index: 1000;
}
.score-label {
    font-size: 12px;
    opacity: 0.9;
    margin-bottom: 5px;
}
.score-value {
    font-size: 24px;
    font-weight: bold;
}
.level-badge {
    margin-top: 8px;
    background: rgba(255,255,255,0.2);
    padding: 4px 12px;
    border-radius: 12px;
    font-size: 12px;
}
</style>


<div class="phase-score-display">
    <span class="score-label">Pontuação da Fase</span>
    <span class="score-value">100 pts</span>
    <span class="level-badge">Nível <span class="level-number">2</span></span>
</div>


<p align="center">&nbsp;</p>
<p align="center"><font color="#008000"><span style="font-weight: 700">FASE 83</span></font></p>
<p>&nbsp;</p>
<p align="center">
<img border="0" src="etimologia.jpg" width="300" height="224"></p>

<p align="center">&nbsp;</p>

<p align="center"><font color="#FFFFFF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
VERBO</font>? = rival no singular multiplicado por dois</p>


<div class="center area-senha">
    <label for="senha"></label><input autocapitalize="off" id="senha" onkeyup="enviarSenha();" placeholder="Senha" type="text">
    <button id="senha-ir" onclick="passarDeFase();">Ir!</button>
    <button id="voltar" onclick="voltar();">Voltar</button>
</div>
</body>
</html>

<!DOCTYPE html>
<html dir="ltr" lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0" name="viewport"/>
    <link href="/images/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
    <link href="/images/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
    <link href="/images/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
    <link color="#5bbad5" href="/images/safari-pinned-tab.svg" rel="mask-icon">
    <meta content="#da532c" name="msapplication-TileColor">
    <meta content="#ffffff" name="theme-color">
    <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" rel="stylesheet">
    <script crossorigin="anonymous"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.slim.min.js" integrity="sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI=" crossorigin="anonymous"></script>
    <link href="/styles/reset.css" rel="stylesheet">
    <link href="/styles/fases.css" rel="stylesheet">
    <link href="/styles/custom.css" rel="stylesheet">
    <script async src="/scripts/fases.js"></script>
    <title>Nova pagina 1</title>
</head>
<body>


<div id="user-progress-badge" class="user-progress-badge">
  <span class="progress-label">Seu Progresso</span>
  <span class="progress-value">--%</span>
  <span class="score-label">Carregando...</span>
</div>

<style>
.user-progress-badge {
    position: absolute;
    top: 20px;
    left: 20px;
    background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
    color: white;
    padding: 15px 20px;
    border-radius: 10px;
    display: flex;
    flex-direction: column;
    align-items: center;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    z-index: 1000;
    min-width: 120px;
}
.progress-label {
    font-size: 11px;
    opacity: 0.9;
    margin-bottom: 5px;
    text-align: center;
}
.progress-value {
    font-size: 28px;
    font-weight: bold;
    line-height: 1;
}
.score-label {
    margin-top: 8px;
    background: rgba(255,255,255,0.2);
    padding: 4px 12px;
    border-radius: 12px;
    font-size: 12px;
}
</style>


<script>
// User Progress Badge - Dynamic Data
(function() {
  function loadUserProgress() {
    const token = localStorage.getItem('authToken');
    if (!token) {
      // Usuário não logado
      const badge = document.getElementById('user-progress-badge');
      if (badge) {
        badge.innerHTML = `
          <span class="progress-label">Seu Progresso</span>
          <span class="progress-value">--%</span>
          <span class="score-label">Não logado</span>
        `;
      }
      return;
    }

    fetch('/auth/profile', {
      headers: { 'Authorization': 'Bearer ' + token }
    })
    .then(res => {
      if (!res.ok) throw new Error('Não autorizado');
      return res.json();
    })
    .then(data => {
      const stats = data.user.stats || {};
      const completedPhases = stats.completedPhases || 0;
      const totalPhases = 99;
      const progress = Math.floor((completedPhases / totalPhases) * 100);
      const score = stats.score || 0;

      const badge = document.getElementById('user-progress-badge');
      if (badge) {
        badge.innerHTML = `
          <span class="progress-label">Seu Progresso</span>
          <span class="progress-value">${progress}%</span>
          <span class="score-label">${score} pts</span>
        `;
      }
    })
    .catch(err => {
      console.log('Erro ao carregar progresso:', err);
      localStorage.removeItem('authToken');
      localStorage.removeItem('user');
    });
  }

  // Carregar quando DOM estiver pronto
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', loadUserProgress);
  } else {
    loadUserProgress();
  }
})();
</script>



<style>
.phase-score-display {
    position: absolute;
    top: 20px;
    right: 20px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 15px 20px;
    border-radius: 10px;
    display: flex;
    flex-direction: column;
    align-items: center;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    z-index: 1000;
}
.score-label {
    font-size: 12px;
    opacity: 0.9;
    margin-bottom: 5px;
}
.score-value {
    font-size: 24px;
    font-weight: bold;
}
.level-badge {
    margin-top: 8px;
    background: rgba(255,255,255,0.2);
    padding: 4px 12px;
    border-radius: 12px;
    font-size: 12px;
}
</style>


<div class="phase-score-display">
    <span class="score-label">Pontuação da Fase</span>
    <span class="score-value">100 pts</span>
    <span class="level-badge">Nível <span class="level-number">2</span></span>
</div>


<p>&nbsp;</p>

<p>&nbsp;</p>

<p>&nbsp;</p>
<p align="left">&nbsp;</p>

<p align="left"><!--[if gte vml 1]><v:shapetype id="_x0000_t202"
 coordsize="21600,21600" o:spt="202" path="m,l,21600r21600,l21600,xe">
 <v:stroke joinstyle="miter"/>
 <v:path gradientshapeok="t" o:connecttype="rect"/>
</v:shapetype><v:shape id="_x0000_s1025" type="#_x0000_t202" alt="" style='position:absolute;
 left:7.5pt;top:88.5pt;width:104.25pt;height:32.25pt;z-index:1' fillcolor="gray"
 stroked="f" strokecolor="none">
 <v:textbox>
<table cellspacing="0" cellpadding="0" width="100%" height="100%">
  <tr>
    <td align="center">
    <p align="left"><font color="#808080">dalton com sorte</font></td>
  </tr>
</table>
 </v:textbox>
</v:shape><![endif]--><![if !vml]><span style='mso-ignore:vglayout;position:
absolute;z-index:1;left:10px;top:118px;width:143px;height:47px'><img width=143
height=47 src="deuteranopia_arquivos/image001.gif" v:shapes="_x0000_s1025"></span><![endif]></p>

<p align="left">
<img border="0" src="deuteranopia.jpg" width="141" height="45"></p>

<p align="left">&nbsp;</p>
<p align="left">&nbsp;</p>
<p align="center">&nbsp;</p>


<div class="center area-senha">
    <label for="senha"></label><input autocapitalize="off" id="senha" onkeyup="enviarSenha();" placeholder="Senha" type="text">
    <button id="senha-ir" onclick="passarDeFase();">Ir!</button>
    <button id="voltar" onclick="voltar();">Voltar</button>
</div>
</body>
</html>
